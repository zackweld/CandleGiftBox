{"version":3,"file":"usePopover.js","sources":["../../../../src/hooks/usePopover.ts"],"sourcesContent":["import { useMemo, useLayoutEffect } from \"react\";\nimport { usePopper } from \"react-popper\";\nimport { Placement } from \"./popoverConstants\";\nimport useForceUpdate from \"./useForceUpdate\";\nimport type { Options, State } from \"@popperjs/core\";\n\nconst { RIGHT_START, RIGHT_END, LEFT_START, LEFT_END } = Placement;\n\nconst FLIP_MODIFIER = {\n  name: \"flip\",\n  options: {\n    fallbackPlacements: [RIGHT_END, LEFT_START, LEFT_END]\n  }\n};\n\nexport default function usePopover(\n  referenceElement: HTMLElement,\n  popperElement: HTMLElement,\n  {\n    isOpen,\n    placement = RIGHT_START\n  }: {\n    isOpen?: boolean;\n    placement?: Placement;\n  }\n) {\n  const forceUpdate = useForceUpdate();\n\n  // we have to use forceUpdate because\n  // usePopper need to run again after any refs changes, even after the first render.\n  useLayoutEffect(() => {\n    forceUpdate();\n  }, [referenceElement, popperElement, forceUpdate]);\n\n  const popperOptions: Pick<Options, \"placement\" | \"modifiers\"> = useMemo(() => {\n    return {\n      placement,\n      modifiers: [\n        FLIP_MODIFIER,\n        {\n          name: \"displayNone\",\n          enabled: true,\n          phase: \"write\",\n          fn: ({ state }: { state: State }) => {\n            // eslint-disable-next-line no-param-reassign\n            state.styles.popper.visibility = isOpen ? \"visible\" : \"hidden\";\n            return state;\n          }\n        }\n      ]\n    };\n  }, [isOpen, placement]);\n\n  const { styles, attributes } = usePopper(referenceElement, popperElement, popperOptions);\n\n  return { styles, attributes };\n}\n"],"names":["RIGHT_START","Placement","FLIP_MODIFIER","name","options","fallbackPlacements","RIGHT_END","LEFT_START","LEFT_END","usePopover","referenceElement","popperElement","_ref","isOpen","_ref$placement","placement","forceUpdate","useForceUpdate","useLayoutEffect","popperOptions","useMemo","modifiers","enabled","phase","fn","_ref2","state","styles","popper","visibility","_usePopper","usePopper","attributes"],"mappings":"mLAMA,IAAQA,EAAiDC,EAAjDD,YAEFE,EAAgB,CACpBC,KAAM,OACNC,QAAS,CACPC,mBAAoB,CALiCJ,EAApCK,UAAoCL,EAAzBM,WAAyBN,EAAbO,YASpB,SAAAC,EACtBC,EACAC,EAA0BC,GAOzB,IALCC,EAAMD,EAANC,OAAMC,EAAAF,EACNG,UAAAA,OAAYf,IAAHc,EAAGd,EAAWc,EAMnBE,EAAcC,IAIpBC,GAAgB,WACdF,GACD,GAAE,CAACN,EAAkBC,EAAeK,IAErC,IAAMG,EAA0DC,GAAQ,WACtE,MAAO,CACLL,UAAAA,EACAM,UAAW,CACTnB,EACA,CACEC,KAAM,cACNmB,SAAS,EACTC,MAAO,QACPC,GAAI,SAAAC,GAAgC,IAA7BC,EAAKD,EAALC,MAGL,OADAA,EAAMC,OAAOC,OAAOC,WAAahB,EAAS,UAAY,SAC/Ca,CACT,IAIR,GAAG,CAACb,EAAQE,IAEZe,EAA+BC,EAAUrB,EAAkBC,EAAeQ,GAE1E,MAAO,CAAEQ,OAFKG,EAANH,OAESK,WAFSF,EAAVE,WAGlB"}