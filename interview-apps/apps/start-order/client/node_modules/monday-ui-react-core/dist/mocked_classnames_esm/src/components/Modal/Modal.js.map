{"version":3,"file":"Modal.js","sources":["../../../../../src/components/Modal/Modal.tsx"],"sourcesContent":["import React, { cloneElement, FC, ReactElement, useCallback, useMemo } from \"react\";\nimport ReactDOM from \"react-dom\";\nimport cx from \"classnames\";\nimport { useA11yDialog } from \"./a11yDialog\";\nimport ModalContent from \"./ModalContent/ModalContent\";\nimport ModalHeader from \"./ModalHeader/ModalHeader\";\nimport useBodyScrollLock from \"./useBodyScrollLock\";\nimport useShowHideModal from \"./useShowHideModal\";\nimport { isModalContent, isModalFooter, isModalHeader, ModalWidth, validateTitleProp } from \"./ModalHelper\";\nimport { NOOP } from \"../../utils/function-utils\";\nimport { withStaticProps } from \"../../types\";\nimport { getTestId } from \"../../tests/test-ids-utils\";\nimport { ComponentDefaultTestId } from \"../../tests/constants\";\nimport styles from \"./Modal.module.scss\";\nimport { useWarnDeprecated } from \"../../utils/warn-deprecated\";\n\nexport interface ModalProps {\n  /**\n   * Id of the modal, used internally and for accessibility\n   */\n  id?: string;\n  \"data-testid\"?: string;\n  /**\n   * Show/hide the Dialog\n   */\n  show: boolean;\n  /**\n   * Heading for the modal, mandatory when ModalHeader isn't provided in children\n   */\n  title?: string;\n  /**\n   * Description for the modal title\n   */\n  description?: string;\n  /**\n   * Called when the modal is closed (by close button/click outside/esc key)\n   */\n  onClose: () => void;\n  /**\n   *  Makes the dialog behave like a modal (preventing closing on click outside of\n   *  ESC key)..\n   */\n  alertDialog?: boolean;\n  /**\n   *  Used for the fromOrigin animation\n   */\n  triggerElement?: Element;\n  /**\n   *  Set the modal's width. Can be one of the presets or any custom size\n   */\n  width?: typeof ModalWidth | string;\n  /**\n   * @deprecated\n   */\n  hideCloseButton?: boolean;\n  /**\n   *  Aria label for the close button\n   */\n  closeButtonAriaLabel?: string;\n  /**\n   *  Add gaps between parts of the modal\n   */\n  contentSpacing?: boolean;\n  /**\n   *  classNames for specific parts of the dialog\n   */\n  classNames?: {\n    container?: string;\n    overlay?: string;\n    modal?: string;\n  };\n  /**\n   *  Dialog content\n   */\n  children?: ReactElement | ReactElement[];\n  /**\n   * z-index attribute of the container\n   */\n  zIndex?: number;\n  /**\n   * If true, the modal will unmount when it's not shown\n   */\n  unmountOnClose?: boolean;\n}\n\nconst Modal: FC<ModalProps> & { width?: typeof ModalWidth } = ({\n  classNames = { container: \"\", overlay: \"\", modal: \"\" },\n  id,\n  show,\n  title = \"\",\n  description = \"\",\n  onClose = NOOP,\n  alertDialog = false,\n  children,\n  triggerElement,\n  width = ModalWidth.DEFAULT,\n  // TODO remove hideCloseButton on the next breaking changes\n  // eslint-disable-next-line\n  hideCloseButton = false,\n  closeButtonAriaLabel = \"Close\",\n  contentSpacing = false,\n  zIndex = 10000,\n  unmountOnClose,\n  \"data-testid\": dataTestId\n}) => {\n  useWarnDeprecated({\n    component: \"Modal\",\n    condition: unmountOnClose === undefined,\n    message:\n      'The \"unmountOnClose\" prop will be set to default in the next major version, i.e. the modal will not render when \"show\" is set to false, which is the recommended behavior. To keep the existing behavior regardless, set \"unmountOnClose\" to false.'\n  });\n\n  const childrenArray: ReactElement[] = useMemo(\n    () => (children ? (React.Children.toArray(children) as ReactElement[]) : []),\n    [children]\n  );\n  validateTitleProp(title, childrenArray);\n\n  const [instance, attr] = useA11yDialog({\n    id,\n    alertDialog\n  });\n\n  const closeIfNotAlertType = useCallback(() => {\n    if (!alertDialog) {\n      onClose?.();\n    }\n  }, [alertDialog, onClose]);\n\n  // lock body scroll when modal is open\n  useBodyScrollLock({ instance });\n\n  // show/hide and animate the modal\n  const { shouldShow } = useShowHideModal({\n    instance,\n    show,\n    triggerElement,\n    onClose,\n    alertDialog\n  });\n\n  const header = useMemo(() => {\n    const { id } = attr.title;\n    const header = childrenArray.find(isModalHeader);\n    if (header) {\n      return cloneElement(header, { id, closeModal: onClose });\n    }\n    return (\n      <ModalHeader\n        title={title}\n        description={description}\n        closeModal={onClose}\n        id={id}\n        closeButtonAriaLabel={closeButtonAriaLabel}\n      />\n    );\n  }, [attr.title, childrenArray, title, description, onClose, closeButtonAriaLabel]);\n\n  const content = useMemo(() => {\n    return (\n      childrenArray.find(isModalContent) || (\n        <ModalContent>{childrenArray.filter(child => !isModalHeader(child) && !isModalFooter(child))}</ModalContent>\n      )\n    );\n  }, [childrenArray]);\n\n  const footer = useMemo(() => {\n    return childrenArray.find(isModalFooter) || null;\n  }, [childrenArray]);\n\n  const customWidth = width !== ModalWidth.DEFAULT && width !== ModalWidth.FULL_WIDTH;\n\n  const dialog = ReactDOM.createPortal(\n    <div\n      {...attr.container}\n      className={cx(styles.container, classNames.container)}\n      data-testid={dataTestId || getTestId(ComponentDefaultTestId.MODAL, id)}\n      style={{ \"--monday-modal-z-index\": zIndex }}\n    >\n      {/* eslint-disable-next-line jsx-a11y/click-events-have-key-events */}\n      <div\n        onClick={closeIfNotAlertType}\n        className={cx(styles.overlay, classNames.overlay)}\n        data-testid={ComponentDefaultTestId.MODAL_OVERLAY}\n      />\n      <div\n        {...attr.dialog}\n        className={cx(styles.dialog, classNames.modal, {\n          [styles.default]: width === ModalWidth.DEFAULT,\n          [styles.full]: width === ModalWidth.FULL_WIDTH,\n          [styles.spacing]: contentSpacing\n        })}\n        style={{ width: customWidth ? width : null }}\n      >\n        {header}\n        {content}\n        {footer}\n      </div>\n    </div>,\n    document.body\n  );\n\n  if (unmountOnClose && !shouldShow) {\n    return null;\n  }\n  return ReactDOM.createPortal(dialog, document.body);\n};\n\nexport default withStaticProps(Modal, {\n  width: ModalWidth\n});\n"],"names":["withStaticProps","_ref","_ref$classNames","classNames","container","overlay","modal","id","show","_ref$title","title","_ref$description","description","_ref$onClose","onClose","NOOP","_ref$alertDialog","alertDialog","children","triggerElement","_ref$width","width","ModalWidth","DEFAULT","_ref$closeButtonAriaL","closeButtonAriaLabel","_ref$contentSpacing","contentSpacing","_ref$zIndex","zIndex","unmountOnClose","dataTestId","useWarnDeprecated","component","condition","undefined","message","childrenArray","useMemo","React","Children","toArray","validateTitleProp","_useA11yDialog","useA11yDialog","_useA11yDialog2","_slicedToArray","instance","attr","closeIfNotAlertType","useCallback","useBodyScrollLock","shouldShow","useShowHideModal","header","find","isModalHeader","cloneElement","closeModal","createElement","ModalHeader","content","isModalContent","ModalContent","filter","child","isModalFooter","footer","customWidth","FULL_WIDTH","dialog","ReactDOM","createPortal","className","cx","styles","getTestId","ComponentDefaultTestId","MODAL","style","onClick","MODAL_OVERLAY","Object","assign","_defineProperty","default","full","spacing","document","body"],"mappings":"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"}