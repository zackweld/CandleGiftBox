{"version":3,"file":"AlertBanner.js","sources":["../../../../../src/components/AlertBanner/AlertBanner.tsx"],"sourcesContent":["import { getStyle } from \"../../helpers/typesciptCssModulesHelper\";\nimport cx from \"classnames\";\nimport React, { ForwardedRef, forwardRef, ReactElement, useMemo } from \"react\";\nimport Button from \"../../components/Button/Button\";\nimport IconButton from \"../../components/IconButton/IconButton\";\nimport CloseSmall from \"../../components/Icon/Icons/components/CloseSmall\";\nimport { AlertBannerBackgroundColor } from \"./AlertBannerConstants\";\nimport { NOOP } from \"../../utils/function-utils\";\nimport VibeComponentProps from \"../../types/VibeComponentProps\";\nimport { AlertBannerLinkProps } from \"./AlertBannerLink/AlertBannerLink\";\nimport { AlertBannerButtonProps } from \"./AlertBannerButton/AlertBannerButton\";\nimport { AlertBannerTextProps } from \"./AlertBannerText/AlertBannerText\";\nimport { ComponentDefaultTestId } from \"../../tests/constants\";\nimport { getTestId } from \"../../tests/test-ids-utils\";\nimport { VibeComponent, withStaticProps } from \"../../types\";\nimport styles from \"./AlertBanner.module.scss\";\nimport Text from \"../Text/Text\";\nimport { AlertBannerContext } from \"./AlertBannerContext\";\n\n// TODO: [breaking] type it to adopt a structure of a text and one (optional) cta (either link/button)\ntype ChildrenType = ReactElement<AlertBannerButtonProps | AlertBannerLinkProps | AlertBannerTextProps>;\n\nexport interface AlertBannerProps extends VibeComponentProps {\n  /**\n   * Set external styling to the progress bar.\n   */\n  className?: string;\n  backgroundColor?: AlertBannerBackgroundColor;\n  isCloseHidden?: boolean;\n  /** ARIA description for the progress bar */\n  ariaLabel?: string;\n  closeButtonAriaLabel?: string;\n  onClose?: (event: React.MouseEvent<HTMLButtonElement>) => void;\n  children?: ChildrenType | ChildrenType[];\n}\n\nconst AlertBanner: VibeComponent<AlertBannerProps> & {\n  backgroundColors?: typeof AlertBannerBackgroundColor;\n} = forwardRef(\n  (\n    {\n      children: originalChildren,\n      className,\n      backgroundColor = AlertBanner.backgroundColors.PRIMARY,\n      onClose = NOOP,\n      ariaLabel = \"\",\n      closeButtonAriaLabel = \"Close\",\n      isCloseHidden = false,\n      id,\n      \"data-testid\": dataTestId\n    },\n    ref: ForwardedRef<HTMLDivElement>\n  ) => {\n    const classNames = useMemo(() => {\n      return cx(className, styles.alertBanner, getStyle(styles, backgroundColor));\n    }, [className, backgroundColor]);\n\n    const isDarkBackground = backgroundColor === AlertBanner.backgroundColors.DARK;\n    const isFixedColor = backgroundColor === AlertBanner.backgroundColors.WARNING;\n    const textColor = useMemo(() => {\n      if (isFixedColor) {\n        return Text.colors.FIXED_DARK;\n      }\n      return isDarkBackground ? Text.colors.ON_INVERTED : Text.colors.ON_PRIMARY;\n    }, [isDarkBackground, isFixedColor]);\n    const children = useMemo(() => {\n      const allChildren = React.Children.toArray(originalChildren) as ReactElement[];\n      const filteredChildren = allChildren.filter(\n        (\n          child: ReactElement & {\n            type: Record<string, unknown>;\n          }\n        ) => {\n          if (child.type.isAlertBannerItem || child.type.displayName === \"MDXCreateElement\") return true;\n          console.error(\n            \"Alert banner child is not supported. Please use AlertBannerText, AlertBannerLink or AlertBannerButton.\",\n            child\n          );\n          return false;\n        }\n      );\n\n      return filteredChildren.map((child, index) => {\n        return React.cloneElement(child, {\n          ...child?.props,\n          marginLeft: index > 0,\n          isDarkBackground\n        });\n      });\n    }, [originalChildren, isDarkBackground]);\n\n    return (\n      <Text\n        type={Text.types.TEXT2}\n        color={textColor}\n        ref={ref}\n        className={classNames}\n        role=\"banner\"\n        aria-label={ariaLabel || \"banner\"}\n        id={id}\n        data-testid={dataTestId || getTestId(ComponentDefaultTestId.ALERT_BANNER, id)}\n      >\n        <AlertBannerContext.Provider value={{ textColor }}>\n          <div className={cx(styles.content)}>\n            {children.map(\n              (\n                child: ReactElement & {\n                  type: Record<string, unknown>;\n                },\n                index\n              ) => {\n                const childTypeIsAlertBannerText = child.type.isAlertBannerText;\n                return (\n                  <div\n                    key={index}\n                    className={cx(styles.contentItem, {\n                      [styles.contentItemText]: childTypeIsAlertBannerText\n                    })}\n                  >\n                    {childTypeIsAlertBannerText ? <div className={cx(styles.ellipsis)}>{child}</div> : child}\n                  </div>\n                );\n              }\n            )}\n          </div>\n        </AlertBannerContext.Provider>\n        <div className={cx(styles.closeButtonWrapper)}>\n          {isCloseHidden ? null : (\n            <IconButton\n              data-testid=\"alert-banner-close-button\"\n              icon={CloseSmall}\n              className={cx(styles.closeBtn)}\n              hideTooltip\n              onClick={onClose}\n              size={Button.sizes.SMALL}\n              kind={IconButton.kinds.TERTIARY}\n              color={isDarkBackground ? Button.colors.ON_INVERTED_BACKGROUND : Button.colors.ON_PRIMARY_COLOR}\n              ariaLabel={closeButtonAriaLabel}\n            />\n          )}\n        </div>\n      </Text>\n    );\n  }\n);\n\nexport default withStaticProps(AlertBanner, { backgroundColors: AlertBannerBackgroundColor });\n"],"names":["AlertBanner","forwardRef","_ref","ref","originalChildren","children","className","_ref$backgroundColor","backgroundColor","backgroundColors","PRIMARY","_ref$onClose","onClose","NOOP","_ref$ariaLabel","ariaLabel","_ref$closeButtonAriaL","closeButtonAriaLabel","_ref$isCloseHidden","isCloseHidden","id","dataTestId","classNames","useMemo","cx","styles","alertBanner","getStyle","isDarkBackground","DARK","isFixedColor","WARNING","textColor","Text","colors","FIXED_DARK","ON_INVERTED","ON_PRIMARY","React","Children","toArray","filter","child","type","isAlertBannerItem","displayName","console","error","map","index","cloneElement","Object","assign","props","marginLeft","types","TEXT2","color","role","getTestId","ComponentDefaultTestId","ALERT_BANNER","createElement","AlertBannerContext","Provider","value","content","childTypeIsAlertBannerText","isAlertBannerText","key","contentItem","_defineProperty","contentItemText","ellipsis","closeButtonWrapper","IconButton","icon","CloseSmall","closeBtn","hideTooltip","onClick","size","Button","sizes","SMALL","kind","kinds","TERTIARY","ON_INVERTED_BACKGROUND","ON_PRIMARY_COLOR","withStaticProps","AlertBannerBackgroundColor"],"mappings":"iyBAoCA,IAAMA,EAEFC,GACF,SAAAC,EAYEC,GACE,IAXUC,EAAgBF,EAA1BG,SACAC,EAASJ,EAATI,UAASC,EAAAL,EACTM,gBAAAA,OAAkBR,IAAHO,EAAGP,EAAYS,iBAAiBC,QAAOH,EAAAI,EAAAT,EACtDU,QAAAA,OAAUC,IAAHF,EAAGE,EAAIF,EAAAG,EAAAZ,EACda,UAAAA,OAAY,IAAHD,EAAG,GAAEA,EAAAE,EAAAd,EACde,qBAAAA,OAAuB,IAAHD,EAAG,QAAOA,EAAAE,EAAAhB,EAC9BiB,cAAAA,OAAgB,IAAHD,GAAQA,EACrBE,EAAElB,EAAFkB,GACeC,EAAUnB,EAAzB,eAIIoB,EAAaC,GAAQ,WACzB,OAAOC,EAAGlB,EAAWmB,EAAOC,YAAaC,EAASF,EAAQjB,GAC5D,GAAG,CAACF,EAAWE,IAEToB,EAAmBpB,IAAoBR,EAAYS,iBAAiBoB,KACpEC,EAAetB,IAAoBR,EAAYS,iBAAiBsB,QAChEC,EAAYT,GAAQ,WACxB,OAAIO,EACKG,EAAKC,OAAOC,WAEdP,EAAmBK,EAAKC,OAAOE,YAAcH,EAAKC,OAAOG,UAClE,GAAG,CAACT,EAAkBE,IAChBzB,EAAWkB,GAAQ,WAiBvB,OAhBoBe,EAAMC,SAASC,QAAQpC,GACNqC,QACnC,SACEC,GAIA,SAAIA,EAAMC,KAAKC,mBAAgD,qBAA3BF,EAAMC,KAAKE,eAC/CC,QAAQC,MACN,yGACAL,IAEK,EACT,IAGsBM,KAAI,SAACN,EAAOO,GAClC,OAAOX,EAAMY,aAAaR,EACrBS,OAAAC,OAAAD,OAAAC,OAAA,CAAA,EAAAV,aAAA,EAAAA,EAAOW,OAAK,CACfC,WAAYL,EAAQ,EACpBrB,iBAAAA,IAEJ,GACF,GAAG,CAACxB,EAAkBwB,IAEtB,OACEU,gBAACL,EAAI,CACHU,KAAMV,EAAKsB,MAAMC,MACjBC,MAAOzB,EACP7B,IAAKA,EACLG,UAAWgB,EACXoC,KAAK,SAAQ,aACD3C,GAAa,SACzBK,GAAIA,EACS,cAAAC,GAAcsC,EAAUC,EAAuBC,aAAczC,IAE1EkB,EAACwB,cAAAC,EAAmBC,SAAQ,CAACC,MAAO,CAAEjC,UAAAA,IACpCM,EAAAwB,cAAA,MAAA,CAAKxD,UAAWkB,EAAGC,EAAOyC,UACvB7D,EAAS2C,KACR,SACEN,EAGAO,GAEA,IAAMkB,EAA6BzB,EAAMC,KAAKyB,kBAC9C,OACE9B,EAAAwB,cAAA,MAAA,CACEO,IAAKpB,EACL3C,UAAWkB,EAAGC,EAAO6C,YAAWC,EAAA,CAAA,EAC7B9C,EAAO+C,gBAAkBL,KAG3BA,EAA6B7B,EAAKwB,cAAA,MAAA,CAAAxD,UAAWkB,EAAGC,EAAOgD,WAAY/B,GAAeA,EAGxF,MAIPJ,EAAAwB,cAAA,MAAA,CAAKxD,UAAWkB,EAAGC,EAAOiD,qBACvBvD,EAAgB,KACfmB,EAACwB,cAAAa,EACa,CAAA,cAAA,4BACZC,KAAMC,EACNvE,UAAWkB,EAAGC,EAAOqD,UACrBC,eACAC,QAASpE,EACTqE,KAAMC,EAAOC,MAAMC,MACnBC,KAAMV,EAAWW,MAAMC,SACvB9B,MAAO7B,EAAmBsD,EAAOhD,OAAOsD,uBAAyBN,EAAOhD,OAAOuD,iBAC/E1E,UAAWE,KAMvB,IAGayE,EAAAA,EAAgB1F,EAAa,CAAES,iBAAkBkF"}