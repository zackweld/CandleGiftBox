{"version":3,"file":"LabelCelebrationAnimation.js","sources":["../../../../../src/components/Label/LabelCelebrationAnimation.tsx"],"sourcesContent":["import React, { cloneElement, forwardRef, useCallback, useRef, useState } from \"react\";\nimport cx from \"classnames\";\nimport useResizeObserver from \"../../hooks/useResizeObserver\";\nimport styles from \"./LabelCelebrationAnimation.module.scss\";\n\nconst DEFAULT_BORDER_RADIUS = 4;\nconst DEFAULT_STROKE_WIDTH = 1;\n\nexport interface LabelCelebrationAnimationProps {\n  children: React.ReactElement;\n  onAnimationEnd: () => void;\n}\n\nfunction LabelCelebrationAnimation({ children, onAnimationEnd }: LabelCelebrationAnimationProps) {\n  const wrapperRef = useRef<HTMLDivElement>();\n  const childRef = useRef<HTMLDivElement>();\n\n  const [path, setPath] = useState<string>();\n\n  const resizeObserverCallback = useCallback(\n    ({ borderBoxSize }: { borderBoxSize: { blockSize: number; inlineSize: number } }) => {\n      const { blockSize: height, inlineSize: width } = borderBoxSize || {};\n\n      if (wrapperRef.current) {\n        const d = getPath({ width, height });\n        setPath(d);\n\n        const perimeter = getPerimeter({ width, height });\n        wrapperRef.current.style.setProperty(\"--container-perimeter\", String(perimeter));\n      }\n    },\n    []\n  );\n\n  useResizeObserver({\n    ref: wrapperRef,\n    callback: resizeObserverCallback,\n    debounceTime: 0\n  });\n\n  const ChildComponentWithRef = forwardRef((_props, ref) =>\n    cloneElement(children, {\n      ref\n    })\n  );\n\n  return (\n    <div className={styles.celebration} ref={wrapperRef}>\n      <svg className={styles.svg}>\n        <path className={cx(styles.stroke, styles.base)} d={path} />\n        <path className={cx(styles.stroke, styles.first)} d={path} />\n        <path className={cx(styles.stroke, styles.second)} d={path} />\n        <path className={cx(styles.stroke, styles.third)} d={path} onAnimationEnd={onAnimationEnd} />\n      </svg>\n      <ChildComponentWithRef ref={childRef} />\n    </div>\n  );\n}\n\nexport default LabelCelebrationAnimation;\n\nfunction getPath({\n  width,\n  height,\n  borderRadius = DEFAULT_BORDER_RADIUS,\n  strokeWidth = DEFAULT_STROKE_WIDTH\n}: {\n  width: number;\n  height: number;\n  borderRadius?: number;\n  strokeWidth?: number;\n}) {\n  const offset = strokeWidth / 2;\n\n  return `M ${width - strokeWidth / 2}, ${borderRadius} V ${\n    height - borderRadius\n  } A ${borderRadius} ${borderRadius} 0 0 1 ${width - borderRadius} ${height - strokeWidth / 2} H ${\n    borderRadius + offset\n  } A ${borderRadius} ${borderRadius} 0 0 1 ${strokeWidth / 2} ${height - borderRadius} V ${\n    borderRadius + offset\n  } A ${borderRadius} ${borderRadius} 0 0 1 ${borderRadius} ${strokeWidth / 2} L ${width - borderRadius}, ${\n    strokeWidth / 2\n  } A ${borderRadius} ${borderRadius} 0 0 1 ${width - strokeWidth / 2} ${borderRadius} Z`;\n}\n\nfunction getPerimeter({\n  width,\n  height,\n  borderRadius = DEFAULT_BORDER_RADIUS\n}: {\n  width: number;\n  height: number;\n  borderRadius?: number;\n}) {\n  const straightWidth = width - 2 * borderRadius;\n  const straightHeight = height - 2 * borderRadius;\n  const cornerCircumference = 2 * Math.PI * borderRadius;\n  return cornerCircumference + 2 * straightWidth + 2 * straightHeight;\n}\n"],"names":["DEFAULT_BORDER_RADIUS","DEFAULT_STROKE_WIDTH","LabelCelebrationAnimation","_ref","children","onAnimationEnd","wrapperRef","useRef","childRef","_useState","useState","_useState2","_slicedToArray","path","setPath","resizeObserverCallback","useCallback","_ref2","_ref3","borderBoxSize","height","blockSize","width","inlineSize","current","d","_ref4","_ref4$borderRadius","borderRadius","_ref4$strokeWidth","strokeWidth","offset","concat","getPath","perimeter","_ref5","_ref5$borderRadius","straightWidth","straightHeight","Math","PI","getPerimeter","style","setProperty","String","useResizeObserver","ref","callback","debounceTime","ChildComponentWithRef","forwardRef","_props","cloneElement","React","createElement","className","styles","celebration","svg","cx","stroke","base","first","second","third"],"mappings":"sTAKA,IAAMA,EAAwB,EACxBC,EAAuB,EAO7B,SAASC,EAAyBC,GAA6D,IAA1DC,EAAQD,EAARC,SAAUC,EAAcF,EAAdE,eACvCC,EAAaC,IACbC,EAAWD,IAEjBE,EAAwBC,IAAkBC,EAAAC,EAAAH,EAAA,GAAnCI,EAAIF,EAAA,GAAEG,EAAOH,EAAA,GAEdI,EAAyBC,GAC7B,SAAAC,GAAoF,IAClFC,EADcD,EAAbE,eACiE,CAAE,EAAjDC,EAAMF,EAAjBG,UAA+BC,EAAKJ,EAAjBK,WAE3B,GAAIjB,EAAWkB,QAAS,CACtB,IAAMC,EAqCd,SAAgBC,GAUf,IATCJ,EAAKI,EAALJ,MACAF,EAAMM,EAANN,OAAMO,EAAAD,EACNE,aAAAA,OAAe5B,IAAH2B,EAAG3B,EAAqB2B,EAAAE,EAAAH,EACpCI,YAAAA,OAAc7B,IAAH4B,EAAG5B,EAAoB4B,EAO5BE,EAASD,EAAc,EAE7B,MAAAE,KAAAA,OAAYV,EAAQQ,EAAc,EAACE,MAAAA,OAAKJ,EAAYI,OAAAA,OAClDZ,EAASQ,EACXI,OAAAA,OAAMJ,EAAYI,KAAAA,OAAIJ,EAAYI,WAAAA,OAAUV,EAAQM,EAAY,KAAAI,OAAIZ,EAASU,EAAc,EAAC,OAAAE,OAC1FJ,EAAeG,EACjB,OAAAC,OAAMJ,EAAY,KAAAI,OAAIJ,EAAY,WAAAI,OAAUF,EAAc,EAAC,KAAAE,OAAIZ,EAASQ,EAAYI,OAAAA,OAClFJ,EAAeG,EACjBC,OAAAA,OAAMJ,EAAYI,KAAAA,OAAIJ,EAAYI,WAAAA,OAAUJ,EAAYI,KAAAA,OAAIF,EAAc,EAACE,OAAAA,OAAMV,EAAQM,EAAY,MAAAI,OACnGF,EAAc,EAChB,OAAAE,OAAMJ,EAAY,KAAAI,OAAIJ,EAAY,WAAAI,OAAUV,EAAQQ,EAAc,EAAC,KAAAE,OAAIJ,EAAY,KACrF,CA3DkBK,CAAQ,CAAEX,MAAAA,EAAOF,OAAAA,IAC3BN,EAAQW,GAER,IAAMS,EA0Dd,SAAqBC,GAQpB,IAPCb,EAAKa,EAALb,MACAF,EAAMe,EAANf,OAAMgB,EAAAD,EACNP,aAAAA,OAAe5B,IAAHoC,EAAGpC,EAAqBoC,EAM9BC,EAAgBf,EAAQ,EAAIM,EAC5BU,EAAiBlB,EAAS,EAAIQ,EAEpC,OAD4B,EAAIW,KAAKC,GAAKZ,EACb,EAAIS,EAAgB,EAAIC,CACvD,CAvE0BG,CAAa,CAAEnB,MAAAA,EAAOF,OAAAA,IACxCd,EAAWkB,QAAQkB,MAAMC,YAAY,wBAAgCT,EAAPU,GAC/D,CACF,GACD,IAGFC,EAAkB,CAChBC,IAAKxC,EACLyC,SAAUhC,EACViC,aAAc,IAGhB,IAAMC,EAAwBC,GAAW,SAACC,EAAQL,GAAG,OACnDM,EAAahD,EAAU,CACrB0C,IAAAA,OAIJ,OACEO,EAAKC,cAAA,MAAA,CAAAC,UAAWC,EAAOC,YAAaX,IAAKxC,GACvC+C,EAAAC,cAAA,MAAA,CAAKC,UAAWC,EAAOE,KACrBL,EAAAC,cAAA,OAAA,CAAMC,UAAWI,EAAGH,EAAOI,OAAQJ,EAAOK,MAAOpC,EAAGZ,IACpDwC,EAAAC,cAAA,OAAA,CAAMC,UAAWI,EAAGH,EAAOI,OAAQJ,EAAOM,OAAQrC,EAAGZ,IACrDwC,EAAAC,cAAA,OAAA,CAAMC,UAAWI,EAAGH,EAAOI,OAAQJ,EAAOO,QAAStC,EAAGZ,IACtDwC,EAAMC,cAAA,OAAA,CAAAC,UAAWI,EAAGH,EAAOI,OAAQJ,EAAOQ,OAAQvC,EAAGZ,EAAMR,eAAgBA,KAE7EgD,EAACC,cAAAL,GAAsBH,IAAKtC,IAGlC"}