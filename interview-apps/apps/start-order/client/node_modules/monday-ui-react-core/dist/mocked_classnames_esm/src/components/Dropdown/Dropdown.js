import{slicedToArray as e,defineProperty as n,toConsumableArray as o}from"../../../_virtual/_rollupPluginBabelHelpers.js";import{getTestId as t,ComponentDefaultTestId as i}from"../../tests/testIds.js";import r from"classnames";import"../../constants/dialog.js";import{SIZES as a}from"../../constants/sizes.js";import"../../constants/positions.js";import s,{forwardRef as l,useRef as c,useMemo as u,useState as d,useCallback as p}from"react";import m,{createFilter as O,components as f}from"react-select";import v from"react-select/async";import{noop as g}from"lodash-es";import{WindowedMenuList as b}from"react-windowed-select";import j from"./components/menu/menu.js";import C from"./components/DropdownIndicator/DropdownIndicator.js";import M from"./components/option/option.js";import y from"./components/singleValue/singleValue.js";import h from"./components/ClearIndicator/ClearIndicator.js";import w from"./components/MultiValueContainer/MultiValueContainer.js";import{DROPDOWN_CHIP_COLORS as S,DROPDOWN_MENU_PLACEMENT as I,DROPDOWN_MENU_POSITION as D,ADD_AUTO_HEIGHT_COMPONENTS as R,defaultCustomStyles as P,DROPDOWN_ID as V,DROPDOWN_MENU_ID as A,DROPDOWN_MENU_ARIA_LABEL as z}from"./DropdownConstants.js";import E,{customTheme as W}from"./Dropdown.styles.js";import x from"./components/Control/Control.js";import L from"./components/menu/menu.module.scss.js";import N from"./Dropdown.module.scss.js";import{withStaticProps as T}from"../../types/withStaticProps.js";var F=l((function(a,l){var O=a.className,S=a.optionWrapperClassName,I=a.singleValueWrapperClassName,D=a.dropdownMenuWrapperClassName,T=a.placeholder,B=void 0===T?"":T,k=a.disabled,H=void 0!==k&&k,K=a.readOnly,U=void 0!==K&&K,_=a.withReadOnlyStyle,q=a.onMenuOpen,G=void 0===q?g:q,J=a.onMenuClose,Q=void 0===J?g:J,X=a.onFocus,Y=void 0===X?g:X,Z=a.onBlur,$=void 0===Z?g:Z,ee=a.onChange,ne=void 0===ee?g:ee,oe=a.searchable,te=void 0===oe||oe,ie=a.options,re=void 0===ie?[]:ie,ae=a.defaultValue,se=a.value,le=a.noOptionsMessage,ce=a.openMenuOnFocus,ue=a.openMenuOnClick,de=a.clearable,pe=void 0===de||de,me=a.OptionRenderer,Oe=a.optionRenderer,fe=a.ValueRenderer,ve=a.valueRenderer,ge=a.menuRenderer,be=a.menuPlacement,je=void 0===be?F.menuPlacements.BOTTOM:be,Ce=a.rtl,Me=a.size,ye=void 0===Me?F.sizes.MEDIUM:Me,he=a.asyncOptions,we=a.cacheOptions,Se=a.defaultOptions,Ie=a.isVirtualized,De=a.menuPortalTarget,Re=a.extraStyles,Pe=void 0===Re?P:Re,Ve=a.maxMenuHeight,Ae=a.menuIsOpen,ze=a.tabIndex,Ee=void 0===ze?"0":ze,We=a.id,xe=void 0===We?V:We,Le=a.menuId,Ne=void 0===Le?A:Le,Te=a.menuAriaLabel,Fe=void 0===Te?z:Te,Be=a.autoFocus,ke=void 0!==Be&&Be,He=a.multi,Ke=void 0!==He&&He,Ue=a.multiline,_e=void 0!==Ue&&Ue,qe=a.onOptionRemove,Ge=a.onOptionSelect,Je=a.onClear,Qe=a.onInputChange,Xe=void 0===Qe?g:Qe,Ye=a.closeMenuOnSelect,Ze=void 0===Ye?!Ke:Ye,$e=a.closeMenuOnScroll,en=void 0!==$e&&$e,nn=a.withMandatoryDefaultOptions,on=void 0!==nn&&nn,tn=a.isOptionSelected,rn=a.insideOverflowContainer,an=void 0!==rn&&rn,sn=a.insideOverflowWithTransformContainer,ln=void 0!==sn&&sn,cn=a.tooltipContent,un=void 0===cn?"":cn,dn=a.onKeyDown,pn=void 0===dn?g:dn,mn=a.isLoading,On=void 0!==mn&&mn,fn=a.loadingMessage,vn=a.ariaLabel,gn=a.tabSelectsValue,bn=void 0===gn||gn,jn=a.popupsContainerSelector,Cn=a.filterOption,Mn=a.menuPosition,yn=void 0===Mn?F.menuPositions.ABSOLUTE:Mn,hn=a["data-testid"],wn=c(),Sn=De||jn&&document.querySelector(jn),In=u((function(){return ae?Array.isArray(ae)?ae.map((function(e){return Object.assign(Object.assign({},e),{isMandatory:!0})})):Object.assign(Object.assign({},ae),{isMandatory:!0}):ae}),[ae]),Dn=d(In||[]),Rn=e(Dn,2),Pn=Rn[1],Vn=Oe||me,An=ve||fe,zn=!!se,En=null!=se?se:Rn[0],Wn=u((function(){return Array.isArray(En)?En.reduce((function(e,o){return Object.assign(Object.assign({},e),n({},o.value,o))}),{}):{}}),[En]),xn=u((function(){return vn||"".concat(U?"Readonly ":""," ").concat(un," ").concat(Array.isArray(En)?"Selected: ".concat(En.map((function(e){return e.label})).join(", ")):"Select")}),[vn,U,En,un]),Ln=Ke?En:se,Nn=u((function(){var o=E({size:ye,rtl:Ce,insideOverflowContainer:an,controlRef:wn,insideOverflowWithTransformContainer:ln}),t=Pe(o),i=Object.entries(t).reduce((function(t,i){var r=e(i,2),a=r[0],s=r[1];return Object.assign(Object.assign({},t),n({},a,(function(e,n){var t=o[a],i=t?t(e,n):e;return s(i,n)})))}),{});if(Ke){_e&&R.forEach((function(e){var n=i[e];i[e]=function(e,o){return Object.assign(Object.assign({},n(e,o)),{height:"auto"})}}));var r=i.valueContainer;i.valueContainer=function(e,n){return Object.assign(Object.assign({},r(e,n)),{paddingLeft:6})}}return i}),[ye,Ce,an,ln,Pe,Ke,_e]),Tn=p((function(e){return s.createElement(j,Object.assign({},e,{id:Ne,ariaLabel:Fe,Renderer:ge,dropdownMenuWrapperClassName:D}))}),[D,ge,Ne,Fe]),Fn=p((function(e){return s.createElement(C,Object.assign({},e,{size:ye}))}),[ye]),Bn=p((function(e){return s.createElement(M,Object.assign({},e,{Renderer:Vn,optionWrapperClassName:S}))}),[Vn,S]),kn=p((function(e){return s.createElement(f.Input,Object.assign({},e,{"aria-label":"Dropdown input","aria-controls":Ne}))}),[Ne]),Hn=p((function(e){return s.createElement(y,Object.assign({},e,{readOnly:U,Renderer:An,selectedOption:En[0],singleValueWrapperClassName:I}))}),[An,U,En,I]),Kn=p((function(e){return s.createElement(h,Object.assign({},e,{size:ye}))}),[ye]),Un=u((function(){return function(e,n){qe&&qe(Wn[e]);var o=Array.isArray(En)?En.filter((function(n){return n.value!==e})):En;ne&&ne(o,n),Pn(o)}}),[ne,qe,En,Wn]),_n=u((function(){return{selectedOptions:En,onSelectedDelete:Un,isMultiline:_e,insideOverflowContainer:an,insideOverflowWithTransformContainer:ln,controlRef:wn,tooltipContent:un,popupsContainerSelector:jn,size:ye}}),[En,Un,_e,an,ln,un,jn,ye]),qn=he?v:m,Gn=Object.assign({},he&&Object.assign({loadOptions:he,cacheOptions:we},Se&&{defaultOptions:Se})),Jn=Object.assign(Object.assign({},!he&&{options:re}),Ke&&{isMulti:!0}),Qn=p((function(e){var n,o=e.target;return!(null===(n=null==o?void 0:o.parentElement)||void 0===n?void 0:n.classList.contains(L.dropdownMenuWrapper))&&(en||an||ln)}),[an,ln,en]);return s.createElement(qn,Object.assign({className:r(N.dropdown,O),selectProps:_n,components:Object.assign(Object.assign({DropdownIndicator:Fn,Menu:Tn,ClearIndicator:Kn,Input:kn,Option:Bn,Control:x,SingleValue:Hn},Ke&&{MultiValue:g,ValueContainer:w}),Ie&&{MenuList:b}),closeMenuOnScroll:Qn,size:ye,noOptionsMessage:le,placeholder:B,isDisabled:H,isClearable:!U&&pe,isSearchable:!U&&te,readOnly:U,withReadOnlyStyle:_,"aria-readonly":U,"aria-label":xn,"aria-details":un,"aria-expanded":!U&&Ae,"aria-haspopup":"listbox","aria-activedescendant":!0,role:"combobox",defaultValue:ae,value:Ln,onMenuOpen:G,onMenuClose:Q,onFocus:Y,onBlur:$,onChange:function(e,n){switch(ne&&ne(e,n),n.action){case"select-option":var t=Ke?n.option:e;Ge&&Ge(t),zn||Pn([].concat(o(En),[t]));break;case"clear":Je&&Je(),zn||Pn(on?In:[])}},onKeyDown:pn,onInputChange:Xe,openMenuOnFocus:ce,openMenuOnClick:ue,isRtl:Ce,styles:Nn,theme:W,maxMenuHeight:Ve,menuPortalTarget:Sn,menuPlacement:je,menuPosition:yn,menuIsOpen:!U&&Ae,tabIndex:Ee,id:xe,"data-testid":hn||t(i.DROPDOWN,xe),autoFocus:ke,closeMenuOnSelect:Ze,ref:l,withMandatoryDefaultOptions:on,isOptionSelected:tn,isLoading:On,loadingMessage:fn,tabSelectsValue:bn,filterOption:Cn},Gn,Jn))})),B=T(F,{size:a,sizes:a,chipColors:S,menuPlacements:I,menuPositions:D,createFilter:O});export{B as default};
//# sourceMappingURL=Dropdown.js.map
